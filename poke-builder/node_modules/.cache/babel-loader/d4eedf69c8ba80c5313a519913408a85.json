{"ast":null,"code":"import _objectSpread from\"D:/ITCoursesProjects/React/PokeBuilder/poke-builder/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"D:/ITCoursesProjects/React/PokeBuilder/poke-builder/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/ITCoursesProjects/React/PokeBuilder/poke-builder/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"D:/ITCoursesProjects/React/PokeBuilder/poke-builder/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"D:/ITCoursesProjects/React/PokeBuilder/poke-builder/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Auxilliary from'../../hoc/Auxilliary';import Poke from'../../components/Poke/Poke';import BuildControls from'../../components/Poke/BuildControls/BuildControls';import Modal from'../../components/UI/Modal/Modal';import OrderSummary from'../../components/Poke/OrderSummary/OrderSummary';import axios from'../../axios-orders';import Spinner from'../../components/UI/Spinner/Spinner';import withErrorHandler from'../../hoc/withErrorHandler/withErrorHandler';import{connect}from'react-redux';import*as actions from'../../store/actions/index';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PokeBuilder=/*#__PURE__*/function(_Component){_inherits(PokeBuilder,_Component);var _super=_createSuper(PokeBuilder);function PokeBuilder(){var _this;_classCallCheck(this,PokeBuilder);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={// purchasable: false,\npurchasing:false};_this.purchasingHandler=function(){if(_this.props.isAuthenticated){_this.setState({purchasing:true});}else{_this.props.onSetAuthRedirectPath('/checkout');_this.props.history.push('/auth');}};_this.purchaseCancelHandler=function(){_this.setState({purchasing:false});};_this.purchaseContinueHandler=function(){_this.props.onInitPurchase();_this.props.history.push('/checkout');};return _this;}_createClass(PokeBuilder,[{key:\"componentDidMount\",value:// purchaseContinueHandler = () => {\n//     const queryParams = [];\n//     for (let i in this.props.ings) {\n//         queryParams.push(encodeURIComponent(i) + '=' + encodeURIComponent(this.props.ings[i]));\n//     }\n//     queryParams.push('price=' + this.props.price);\n//     const queryString = queryParams.join('&');\n//     this.props.history.push(\n//         {\n//             pathname: '/checkout',\n//             search: '?' + queryString\n//         });\n// }\nfunction componentDidMount(){this.props.onInitIngredients();}},{key:\"updatePurchaseState\",value:function updatePurchaseState(ingredients){var sum=Object.keys(ingredients).map(function(igKey){return ingredients[igKey];}).reduce(function(sum,el){return sum+el;},0);return sum>0;}// addIngredientHandler = (type) => {\n//     const oldCount = this.props.ings[type];\n//     const updatedCount = oldCount + 1;\n//     const updatedIngredients = { ...this.props.ings };\n//     updatedIngredients[type] = updatedCount;\n//     const newPrice = this.props.price + INGREDIENT_PRICE[type];\n//     this.setState({ totalPrice: newPrice, ingredients: updatedIngredients });\n//     this.updatePurchaseState(updatedIngredients);\n// }\n// removeIngredientHandler = (type) => {\n//     const ol dCount = this.props.ings[type];\n//     const updatedCount = oldCount - 1;\n//     if (updatedCount < 0) {\n//         return;\n//     }\n//     const updatedIngredients = { ...this.props.ings };\n//     updatedIngredients[type] = updatedCount;\n//     const newPrice = this.props.price - INGREDIENT_PRICE[type];\n//     this.setState({ totalPrice: newPrice, ingredients: updatedIngredients });\n//     this.updatePurchaseState(updatedIngredients);\n// }\n},{key:\"render\",value:function render(){var disableInfo=_objectSpread({},this.props.ings);for(var key in disableInfo){disableInfo[key]=disableInfo[key]<=0;}// if (this.state.loading) {\n//     orderSummary = <Spinner />\n// }\nvar orderSummary=null;var poke=this.props.error?/*#__PURE__*/_jsx(\"p\",{children:\"Ingredients cannot be loaded\"}):/*#__PURE__*/_jsx(Spinner,{});if(this.props.ings){poke=/*#__PURE__*/_jsxs(Auxilliary,{children:[/*#__PURE__*/_jsx(Poke,{ingredients:this.props.ings}),/*#__PURE__*/_jsx(BuildControls,{isAuth:this.props.isAuthenticated,ingredientAdded:this.props.onIngredientAdded,ingredientRemoved:this.props.onIngredientRemoved,totalPrice:this.props.price,purchasable:this.updatePurchaseState(this.props.ings),ordered:this.purchasingHandler,disable:disableInfo})]});orderSummary=/*#__PURE__*/_jsx(OrderSummary,{price:this.props.price.toFixed(2),ingredients:this.props.ings,purchaseCancelled:this.purchaseCancelHandler,purchaseContinued:this.purchaseContinueHandler});}if(this.props.ingredients===null){orderSummary=/*#__PURE__*/_jsx(Spinner,{});}return/*#__PURE__*/_jsxs(Auxilliary,{children:[/*#__PURE__*/_jsx(Modal,{show:this.state.purchasing,modalClosed:this.purchaseCancelHandler,children:orderSummary}),poke]});}}]);return PokeBuilder;}(Component);var mapStateToProps=function mapStateToProps(state){return{ings:state.pokeBuilder.ingredients,price:state.pokeBuilder.totalPrice,error:state.pokeBuilder.error,isAuthenticated:state.auth.token!==null};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{onIngredientAdded:function onIngredientAdded(ingName){return dispatch(actions.addIngredient(ingName));},onIngredientRemoved:function onIngredientRemoved(ingName){return dispatch(actions.removeIngredient(ingName));},onInitIngredients:function onInitIngredients(){return dispatch(actions.initIngredients());},onInitPurchase:function onInitPurchase(){return dispatch(actions.purchaseInit());},onSetAuthRedirectPath:function onSetAuthRedirectPath(path){return dispatch(actions.setAuthRedirectPath(path));}};};export default connect(mapStateToProps,mapDispatchToProps)(withErrorHandler(PokeBuilder,axios));","map":{"version":3,"sources":["D:/ITCoursesProjects/React/PokeBuilder/poke-builder/src/containers/PokeBuilder/PokeBuilder.js"],"names":["React","Component","Auxilliary","Poke","BuildControls","Modal","OrderSummary","axios","Spinner","withErrorHandler","connect","actions","PokeBuilder","state","purchasing","purchasingHandler","props","isAuthenticated","setState","onSetAuthRedirectPath","history","push","purchaseCancelHandler","purchaseContinueHandler","onInitPurchase","onInitIngredients","ingredients","sum","Object","keys","map","igKey","reduce","el","disableInfo","ings","key","orderSummary","poke","error","onIngredientAdded","onIngredientRemoved","price","updatePurchaseState","toFixed","mapStateToProps","pokeBuilder","totalPrice","auth","token","mapDispatchToProps","dispatch","ingName","addIngredient","removeIngredient","initIngredients","purchaseInit","path","setAuthRedirectPath"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport Auxilliary from '../../hoc/Auxilliary';\r\nimport Poke from '../../components/Poke/Poke';\r\nimport BuildControls from '../../components/Poke/BuildControls/BuildControls';\r\nimport Modal from '../../components/UI/Modal/Modal';\r\nimport OrderSummary from '../../components/Poke/OrderSummary/OrderSummary';\r\nimport axios from '../../axios-orders';\r\nimport Spinner from '../../components/UI/Spinner/Spinner';\r\nimport withErrorHandler from '../../hoc/withErrorHandler/withErrorHandler';\r\nimport { connect } from 'react-redux';\r\nimport * as actions from '../../store/actions/index';\r\n\r\n\r\nclass PokeBuilder extends Component {\r\n\r\n    state = {\r\n        // purchasable: false,\r\n        purchasing: false,\r\n    };\r\n\r\n    purchasingHandler = () => {\r\n        if(this.props.isAuthenticated){\r\n            this.setState({ purchasing: true });\r\n        }\r\n        else{\r\n            this.props.onSetAuthRedirectPath('/checkout')\r\n            this.props.history.push('/auth');\r\n        }\r\n    }\r\n\r\n    purchaseCancelHandler = () => {\r\n        this.setState({ purchasing: false });\r\n    }\r\n\r\n    // purchaseContinueHandler = () => {\r\n    //     const queryParams = [];\r\n    //     for (let i in this.props.ings) {\r\n    //         queryParams.push(encodeURIComponent(i) + '=' + encodeURIComponent(this.props.ings[i]));\r\n    //     }\r\n    //     queryParams.push('price=' + this.props.price);\r\n    //     const queryString = queryParams.join('&');\r\n    //     this.props.history.push(\r\n    //         {\r\n    //             pathname: '/checkout',\r\n    //             search: '?' + queryString\r\n    //         });\r\n    // }\r\n    componentDidMount() {\r\n        this.props.onInitIngredients()\r\n    }\r\n\r\n    purchaseContinueHandler = () => {\r\n        this.props.onInitPurchase();\r\n        this.props.history.push('/checkout');\r\n    }\r\n\r\n    updatePurchaseState(ingredients) {\r\n        const sum = Object.keys(ingredients)\r\n            .map(igKey => {\r\n                return ingredients[igKey];\r\n            })\r\n            .reduce((sum, el) => {\r\n                return sum + el;\r\n            }, 0);\r\n        return sum > 0\r\n    }\r\n\r\n    // addIngredientHandler = (type) => {\r\n    //     const oldCount = this.props.ings[type];\r\n    //     const updatedCount = oldCount + 1;\r\n    //     const updatedIngredients = { ...this.props.ings };\r\n    //     updatedIngredients[type] = updatedCount;\r\n\r\n    //     const newPrice = this.props.price + INGREDIENT_PRICE[type];\r\n    //     this.setState({ totalPrice: newPrice, ingredients: updatedIngredients });\r\n    //     this.updatePurchaseState(updatedIngredients);\r\n\r\n    // }\r\n\r\n    // removeIngredientHandler = (type) => {\r\n    //     const ol dCount = this.props.ings[type];\r\n    //     const updatedCount = oldCount - 1;\r\n    //     if (updatedCount < 0) {\r\n    //         return;\r\n    //     }\r\n\r\n    //     const updatedIngredients = { ...this.props.ings };\r\n    //     updatedIngredients[type] = updatedCount;\r\n\r\n    //     const newPrice = this.props.price - INGREDIENT_PRICE[type];\r\n    //     this.setState({ totalPrice: newPrice, ingredients: updatedIngredients });\r\n    //     this.updatePurchaseState(updatedIngredients);\r\n    // }\r\n\r\n\r\n    render() {\r\n        const disableInfo = {\r\n            ...this.props.ings\r\n        };\r\n        for (let key in disableInfo) {\r\n            disableInfo[key] = disableInfo[key] <= 0;\r\n        }\r\n\r\n\r\n        // if (this.state.loading) {\r\n        //     orderSummary = <Spinner />\r\n        // }\r\n        let orderSummary = null;\r\n        let poke = this.props.error ? <p>Ingredients cannot be loaded</p> : <Spinner />;\r\n        if (this.props.ings) {\r\n            poke = <Auxilliary>\r\n                <Poke ingredients={this.props.ings} />\r\n                <BuildControls\r\n                    isAuth = {this.props.isAuthenticated}\r\n                    ingredientAdded={this.props.onIngredientAdded}\r\n                    ingredientRemoved={this.props.onIngredientRemoved}\r\n                    totalPrice={this.props.price}\r\n                    purchasable={this.updatePurchaseState(this.props.ings)}\r\n                    ordered={this.purchasingHandler}\r\n                    disable={disableInfo} />\r\n            </Auxilliary>;\r\n\r\n            orderSummary = <OrderSummary\r\n                price={this.props.price.toFixed(2)}\r\n                ingredients={this.props.ings}\r\n                purchaseCancelled={this.purchaseCancelHandler}\r\n                purchaseContinued={this.purchaseContinueHandler} />\r\n        }\r\n        if (this.props.ingredients === null) {\r\n            orderSummary = <Spinner></Spinner>\r\n        }\r\n        return (\r\n            <Auxilliary>                \r\n                <Modal\r\n                show={this.state.purchasing}\r\n                modalClosed={this.purchaseCancelHandler}>\r\n                {orderSummary}\r\n            </Modal>\r\n                {poke}\r\n                </Auxilliary>\r\n\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        ings: state.pokeBuilder.ingredients,\r\n        price: state.pokeBuilder.totalPrice,\r\n        error: state.pokeBuilder.error,\r\n        isAuthenticated: state.auth.token !== null\r\n    };\r\n}\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        onIngredientAdded: (ingName) => dispatch(actions.addIngredient(ingName)),\r\n        onIngredientRemoved: (ingName) => dispatch(actions.removeIngredient(ingName)),\r\n        onInitIngredients: () => dispatch(actions.initIngredients()),\r\n        onInitPurchase:() => dispatch(actions.purchaseInit()),\r\n        onSetAuthRedirectPath:(path)=> dispatch(actions.setAuthRedirectPath(path))\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withErrorHandler(PokeBuilder, axios));"]},"metadata":{},"sourceType":"module"}